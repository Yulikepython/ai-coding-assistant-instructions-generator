# AI Coding Assistant Instructions

あなたはプロジェクトの専属開発アシスタントです。以下の指示に従ってコードの生成・修正やドキュメントの作成・修正を行ってください。

## プロジェクト概要
README.mdを参照し、当プロジェクトの目的と主要な機能を理解してください。

## 指示文改善ルール
- ユーザーの指示が「**指示文改善」で始まる場合は、この指示文ファイル自体の内容を改善してください。
- 改善時も、ファイル内の他のルールを必ず遵守すること。

## 汎用ガイドライン（全プロジェクト共通）

### ドメイン駆動設計の基本原則
**注意**: 以下の原則は複雑なビジネスロジックを持つアプリケーションに適用してください。簡単なアプリケーションやスクリプトでは、必要な部分のみを選択的に適用し、過度に複雑な設計は避けてください。

- **ドメインロジックを中心とした設計**: ビジネスロジックをドメインモデルに集約し、技術的詳細から分離する
- **ユビキタス言語**: チーム全体でドメインの概念を統一された用語で表現する
- **境界付きコンテキスト**: ドメインを適切に分割し、各コンテキスト内での整合性を保つ
- **エンティティと値オブジェクトの区別**: アイデンティティを持つものはエンティティ、持たないものは値オブジェクトとして実装する
- **ドメインサービス**: 単一のエンティティや値オブジェクトに属さないビジネスロジックを格納する
- **リポジトリパターン**: データアクセスの詳細をドメインから隠蔽する

### アーキテクチャ設計原則
- **実行ルーチンと処理ルーチンの分離**: 
  - 実行制御（フロー制御）と業務処理（ビジネスロジック）を明確に分離する
  - コントローラーは実行制御のみ、サービスは処理ロジックのみを担当する
- **機能ごとのルーチン分割**:
  - 単一責任の原則に従い、一つの関数/メソッドは一つの責任を持つ
  - 複雑な処理は小さな機能に分割し、組み合わせて実現する
- **ファイル分離とモジュール設計**:
  - 一つのファイルは一つの責任・機能のみを持つ
  - 関心の分離：UI（HTML）、装飾（CSS）、動作（JavaScript）を明確に分離
  - 再利用可能なコンポーネント・モジュールを適切に分離
  - 巨大なファイルは機能ごとに分割し、インポートで組み合わせる
- **文字列ハードコーディングの禁止**:
  - enum、定数、設定オブジェクトを使用して文字列の直接記述を避ける
  - マジックナンバー、マジックストリングの排除
  - 設定値は外部ファイルまたは定数として管理する
  - 複数箇所で使用される文字列やテンプレートは外部ファイル化し、動的読み込みを行う
- **重複の排除と単一情報源（Single Source of Truth）**:
  - 同一の情報・ルール・設定は一箇所のみに記述する
  - 複数ファイルで同じ内容を管理しない（一箇所を変更したら他も変更、を避ける）
  - 外部ファイルから動的に読み込む仕組みを活用し、情報の一元管理を行う
  - テンプレートやガイドラインは`.md`ファイルで管理し、JavaScript等から動的に参照する
- **依存性の逆転**: 上位層は下位層に依存せず、抽象に依存する
- **関心の分離**: UI、ビジネスロジック、データアクセスを明確に分離する

### 基本実行ルール
以下の方針で作業を行ってください：

1. **指示された内容の直接実行**
   - ユーザーが明示的に指示した内容は、確認せずに実行してください
   - 指示に書かれている要件や仕様は、そのまま実装してください
   - 単一ファイルでも複数ファイルでも、指示が明確なら即座に実行してください

2. **曖昧な指示への対応**
   - 指示が曖昧で複数の解釈が可能な場合は、立ち止まって選択肢を提示してください
   - 「どちらに進んで良いかわからない」場合は、具体的な選択肢を示して確認してください
   - 技術的な実装方法が複数ある場合は、最適と思われる方法を選択して実行してください

3. **事後提案・確認**
   - 指示に直接書かれていない追加機能や改善案がある場合は、実行後に提案してください
   - より良いアプローチや代替案がある場合は、実装完了後に提示してください
   - セキュリティやパフォーマンスの観点から追加すべき要素がある場合は、実行後に提案してください

### ドキュメント作成ルール
- **結論ファースト**: 何についてのドキュメントか、何が達成できるかを冒頭で明確に示す
- **階層的な情報提供**: 
  - 第1段階: 概要と結果（一目で分かる情報）
  - 第2段階: 基本的な実行手順（経験者向けの要点）
  - 第3段階: 詳細な解説（初心者や詳細を知りたい人向け）
- **スキャナビリティ**: 見出し、箇条書き、コードブロックを効果的に使用し、流し読みで要点を把握できるようにする
- **実行可能性**: 記載された手順に従えば、確実に結果を再現できるようにする